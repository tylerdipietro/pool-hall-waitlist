{"ast":null,"code":"import _slicedToArray from\"@babel/runtime/helpers/slicedToArray\";var _Constants$expoConfig,_Constants$expoConfig2;import React,{createContext,useState,useEffect}from'react';import Constants from'expo-constants';import{jsx as _jsx}from\"react/jsx-runtime\";var API_BASE_URL=((_Constants$expoConfig=Constants.expoConfig)==null?void 0:(_Constants$expoConfig2=_Constants$expoConfig.extra)==null?void 0:_Constants$expoConfig2.apiBaseUrl)||'http://localhost:3000';export var AuthContext=createContext();export function AuthProvider(_ref){var children=_ref.children;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),user=_useState2[0],setUser=_useState2[1];var _useState3=useState(true),_useState4=_slicedToArray(_useState3,2),loading=_useState4[0],setLoading=_useState4[1];useEffect(function(){fetch(`${API_BASE_URL}/api/auth/success`,{credentials:'include'}).then(function(res){if(res.status===200)return res.json();throw new Error('Not authenticated');}).then(function(data){if(data.success){setUser(data.user);}else{setUser(null);}}).catch(function(){return setUser(null);}).finally(function(){return setLoading(false);});},[]);return _jsx(AuthContext.Provider,{value:{user:user,setUser:setUser,loading:loading},children:children});}","map":{"version":3,"names":["React","createContext","useState","useEffect","Constants","jsx","_jsx","API_BASE_URL","_Constants$expoConfig","expoConfig","_Constants$expoConfig2","extra","apiBaseUrl","AuthContext","AuthProvider","_ref","children","_useState","_useState2","_slicedToArray","user","setUser","_useState3","_useState4","loading","setLoading","fetch","credentials","then","res","status","json","Error","data","success","catch","finally","Provider","value"],"sources":["D:/pool-hall-waitlist/frontend/contexts/AuthContext.js"],"sourcesContent":["import React, { createContext, useState, useEffect } from 'react';\r\nimport Constants from 'expo-constants';\r\n\r\nconst API_BASE_URL = Constants.expoConfig?.extra?.apiBaseUrl || 'http://localhost:3000';\r\n\r\nexport const AuthContext = createContext();\r\n\r\nexport function AuthProvider({ children }) {\r\n  const [user, setUser] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  useEffect(() => {\r\n  fetch(`${API_BASE_URL}/api/auth/success`, {\r\n    credentials: 'include', // Important to send cookies/session\r\n  })\r\n  .then((res) => {\r\n    if (res.status === 200) return res.json();\r\n    throw new Error('Not authenticated');\r\n  })\r\n  .then((data) => {\r\n    if (data.success) {\r\n      setUser(data.user);\r\n    } else {\r\n      setUser(null);\r\n    }\r\n  })\r\n  .catch(() => setUser(null))\r\n  .finally(() => setLoading(false));\r\n}, []);\r\n\r\n\r\n  return (\r\n    <AuthContext.Provider value={{ user, setUser, loading }}>\r\n      {children}\r\n    </AuthContext.Provider>\r\n  );\r\n}\r\n"],"mappings":"kHAAA,MAAO,CAAAA,KAAK,EAAIC,aAAa,CAAEC,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CACjE,MAAO,CAAAC,SAAS,KAAM,gBAAgB,CAAC,OAAAC,GAAA,IAAAC,IAAA,yBAEvC,GAAM,CAAAC,YAAY,CAAG,EAAAC,qBAAA,CAAAJ,SAAS,CAACK,UAAU,gBAAAC,sBAAA,CAApBF,qBAAA,CAAsBG,KAAK,eAA3BD,sBAAA,CAA6BE,UAAU,GAAI,uBAAuB,CAEvF,MAAO,IAAM,CAAAC,WAAW,CAAGZ,aAAa,CAAC,CAAC,CAE1C,MAAO,SAAS,CAAAa,YAAYA,CAAAC,IAAA,CAAe,IAAZ,CAAAC,QAAQ,CAAAD,IAAA,CAARC,QAAQ,CACrC,IAAAC,SAAA,CAAwBf,QAAQ,CAAC,IAAI,CAAC,CAAAgB,UAAA,CAAAC,cAAA,CAAAF,SAAA,IAA/BG,IAAI,CAAAF,UAAA,IAAEG,OAAO,CAAAH,UAAA,IACpB,IAAAI,UAAA,CAA8BpB,QAAQ,CAAC,IAAI,CAAC,CAAAqB,UAAA,CAAAJ,cAAA,CAAAG,UAAA,IAArCE,OAAO,CAAAD,UAAA,IAAEE,UAAU,CAAAF,UAAA,IAE1BpB,SAAS,CAAC,UAAM,CAChBuB,KAAK,CAAC,GAAGnB,YAAY,mBAAmB,CAAE,CACxCoB,WAAW,CAAE,SACf,CAAC,CAAC,CACDC,IAAI,CAAC,SAACC,GAAG,CAAK,CACb,GAAIA,GAAG,CAACC,MAAM,GAAK,GAAG,CAAE,MAAO,CAAAD,GAAG,CAACE,IAAI,CAAC,CAAC,CACzC,KAAM,IAAI,CAAAC,KAAK,CAAC,mBAAmB,CAAC,CACtC,CAAC,CAAC,CACDJ,IAAI,CAAC,SAACK,IAAI,CAAK,CACd,GAAIA,IAAI,CAACC,OAAO,CAAE,CAChBb,OAAO,CAACY,IAAI,CAACb,IAAI,CAAC,CACpB,CAAC,IAAM,CACLC,OAAO,CAAC,IAAI,CAAC,CACf,CACF,CAAC,CAAC,CACDc,KAAK,CAAC,iBAAM,CAAAd,OAAO,CAAC,IAAI,CAAC,GAAC,CAC1Be,OAAO,CAAC,iBAAM,CAAAX,UAAU,CAAC,KAAK,CAAC,GAAC,CACnC,CAAC,CAAE,EAAE,CAAC,CAGJ,MACE,CAAAnB,IAAA,CAACO,WAAW,CAACwB,QAAQ,EAACC,KAAK,CAAE,CAAElB,IAAI,CAAJA,IAAI,CAAEC,OAAO,CAAPA,OAAO,CAAEG,OAAO,CAAPA,OAAQ,CAAE,CAAAR,QAAA,CACrDA,QAAQ,CACW,CAAC,CAE3B","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}