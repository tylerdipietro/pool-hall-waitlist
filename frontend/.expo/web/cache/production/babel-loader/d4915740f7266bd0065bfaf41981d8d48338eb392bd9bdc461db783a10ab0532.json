{"ast":null,"code":"import _slicedToArray from\"@babel/runtime/helpers/slicedToArray\";import React,{createContext,useState,useEffect}from'react';import Constants from'expo-constants';import{jsx as _jsx}from\"react/jsx-runtime\";export var AuthContext=createContext();export function AuthProvider(_ref){var children=_ref.children;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),user=_useState2[0],setUser=_useState2[1];var _useState3=useState(true),_useState4=_slicedToArray(_useState3,2),loading=_useState4[0],setLoading=_useState4[1];useEffect(function(){fetch(`${API_BASE_URL}/api/auth/success`,{credentials:'include'}).then(function(res){if(res.status===200)return res.json();throw new Error('Not authenticated');}).then(function(data){if(data.success){setUser(data.user);}else{setUser(null);}}).catch(function(){return setUser(null);}).finally(function(){return setLoading(false);});},[]);return _jsx(AuthContext.Provider,{value:{user:user,setUser:setUser,loading:loading},children:children});}","map":{"version":3,"names":["React","createContext","useState","useEffect","Constants","jsx","_jsx","AuthContext","AuthProvider","_ref","children","_useState","_useState2","_slicedToArray","user","setUser","_useState3","_useState4","loading","setLoading","fetch","API_BASE_URL","credentials","then","res","status","json","Error","data","success","catch","finally","Provider","value"],"sources":["D:/pool-hall-waitlist/frontend/contexts/AuthContext.js"],"sourcesContent":["import React, { createContext, useState, useEffect } from 'react';\r\nimport Constants from 'expo-constants';\r\n\r\nexport const AuthContext = createContext();\r\n\r\nexport function AuthProvider({ children }) {\r\n  const [user, setUser] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  useEffect(() => {\r\n  fetch(`${API_BASE_URL}/api/auth/success`, {\r\n    credentials: 'include', // Important to send cookies/session\r\n  })\r\n  .then((res) => {\r\n    if (res.status === 200) return res.json();\r\n    throw new Error('Not authenticated');\r\n  })\r\n  .then((data) => {\r\n    if (data.success) {\r\n      setUser(data.user);\r\n    } else {\r\n      setUser(null);\r\n    }\r\n  })\r\n  .catch(() => setUser(null))\r\n  .finally(() => setLoading(false));\r\n}, []);\r\n\r\n\r\n  return (\r\n    <AuthContext.Provider value={{ user, setUser, loading }}>\r\n      {children}\r\n    </AuthContext.Provider>\r\n  );\r\n}\r\n"],"mappings":"iEAAA,MAAO,CAAAA,KAAK,EAAIC,aAAa,CAAEC,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CACjE,MAAO,CAAAC,SAAS,KAAM,gBAAgB,CAAC,OAAAC,GAAA,IAAAC,IAAA,yBAEvC,MAAO,IAAM,CAAAC,WAAW,CAAGN,aAAa,CAAC,CAAC,CAE1C,MAAO,SAAS,CAAAO,YAAYA,CAAAC,IAAA,CAAe,IAAZ,CAAAC,QAAQ,CAAAD,IAAA,CAARC,QAAQ,CACrC,IAAAC,SAAA,CAAwBT,QAAQ,CAAC,IAAI,CAAC,CAAAU,UAAA,CAAAC,cAAA,CAAAF,SAAA,IAA/BG,IAAI,CAAAF,UAAA,IAAEG,OAAO,CAAAH,UAAA,IACpB,IAAAI,UAAA,CAA8Bd,QAAQ,CAAC,IAAI,CAAC,CAAAe,UAAA,CAAAJ,cAAA,CAAAG,UAAA,IAArCE,OAAO,CAAAD,UAAA,IAAEE,UAAU,CAAAF,UAAA,IAE1Bd,SAAS,CAAC,UAAM,CAChBiB,KAAK,CAAC,GAAGC,YAAY,mBAAmB,CAAE,CACxCC,WAAW,CAAE,SACf,CAAC,CAAC,CACDC,IAAI,CAAC,SAACC,GAAG,CAAK,CACb,GAAIA,GAAG,CAACC,MAAM,GAAK,GAAG,CAAE,MAAO,CAAAD,GAAG,CAACE,IAAI,CAAC,CAAC,CACzC,KAAM,IAAI,CAAAC,KAAK,CAAC,mBAAmB,CAAC,CACtC,CAAC,CAAC,CACDJ,IAAI,CAAC,SAACK,IAAI,CAAK,CACd,GAAIA,IAAI,CAACC,OAAO,CAAE,CAChBd,OAAO,CAACa,IAAI,CAACd,IAAI,CAAC,CACpB,CAAC,IAAM,CACLC,OAAO,CAAC,IAAI,CAAC,CACf,CACF,CAAC,CAAC,CACDe,KAAK,CAAC,iBAAM,CAAAf,OAAO,CAAC,IAAI,CAAC,GAAC,CAC1BgB,OAAO,CAAC,iBAAM,CAAAZ,UAAU,CAAC,KAAK,CAAC,GAAC,CACnC,CAAC,CAAE,EAAE,CAAC,CAGJ,MACE,CAAAb,IAAA,CAACC,WAAW,CAACyB,QAAQ,EAACC,KAAK,CAAE,CAAEnB,IAAI,CAAJA,IAAI,CAAEC,OAAO,CAAPA,OAAO,CAAEG,OAAO,CAAPA,OAAQ,CAAE,CAAAR,QAAA,CACrDA,QAAQ,CACW,CAAC,CAE3B","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}