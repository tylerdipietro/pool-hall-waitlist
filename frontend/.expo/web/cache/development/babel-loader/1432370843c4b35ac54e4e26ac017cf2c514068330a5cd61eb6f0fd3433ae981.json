{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nvar _jsxFileName = \"D:\\\\pool-hall-waitlist\\\\frontend\\\\App.js\",\n  _Constants$expoConfig,\n  _Constants$expoConfig2;\nimport React, { useState, useEffect, useContext } from 'react';\nimport SafeAreaView from \"react-native-web/dist/exports/SafeAreaView\";\nimport ScrollView from \"react-native-web/dist/exports/ScrollView\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport Platform from \"react-native-web/dist/exports/Platform\";\nimport Dashboard from './components/Dashboard';\nimport LoginScreen from './components/LoginScreen';\nimport { AuthProvider, AuthContext } from './contexts/AuthContext';\nimport io from 'socket.io-client';\nimport Constants from 'expo-constants';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar API_BASE_URL = ((_Constants$expoConfig = Constants.expoConfig) == null ? void 0 : (_Constants$expoConfig2 = _Constants$expoConfig.extra) == null ? void 0 : _Constants$expoConfig2.apiBaseUrl) || 'http://localhost:3000';\nfunction AppInner() {\n  var _useContext = useContext(AuthContext),\n    user = _useContext.user,\n    setUser = _useContext.setUser;\n  var _useState = useState([]),\n    _useState2 = _slicedToArray(_useState, 2),\n    queue = _useState2[0],\n    setQueue = _useState2[1];\n  var _useState3 = useState([]),\n    _useState4 = _slicedToArray(_useState3, 2),\n    tables = _useState4[0],\n    setTables = _useState4[1];\n  var _useState5 = useState(null),\n    _useState6 = _slicedToArray(_useState5, 2),\n    socket = _useState6[0],\n    setSocket = _useState6[1];\n  var _useState7 = useState(true),\n    _useState8 = _slicedToArray(_useState7, 2),\n    loading = _useState8[0],\n    setLoading = _useState8[1];\n  useEffect(function () {\n    fetch(`${API_BASE_URL}/api/auth/success`, {\n      credentials: 'include'\n    }).then(function (res) {\n      return res.json();\n    }).then(function (data) {\n      if (data.success) {\n        setUser(data.user);\n      } else {\n        setUser(null);\n      }\n    }).catch(function (err) {\n      console.error('Auth check failed:', err);\n      setUser(null);\n    }).finally(function () {\n      return setLoading(false);\n    });\n  }, [setUser]);\n  useEffect(function () {\n    if (!user) return;\n    var socketClient = io(API_BASE_URL, {\n      withCredentials: true\n    });\n    setSocket(socketClient);\n    socketClient.on('state_update', function (_ref) {\n      var queue = _ref.queue,\n        tables = _ref.tables;\n      setQueue(queue);\n      setTables(tables);\n    });\n    socketClient.on('connect_error', function (err) {\n      console.error('Socket connection error:', err);\n    });\n    return function () {\n      socketClient.disconnect();\n    };\n  }, [user]);\n  if (loading) {\n    return _jsxDEV(Text, {\n      style: {\n        textAlign: 'center',\n        marginTop: 50\n      },\n      children: \"Loading...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 12\n    }, this);\n  }\n  if (!user) {\n    return _jsxDEV(LoginScreen, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 12\n    }, this);\n  }\n  return _jsxDEV(SafeAreaView, {\n    style: styles.container,\n    children: _jsxDEV(ScrollView, {\n      children: [_jsxDEV(Text, {\n        style: styles.title,\n        children: \"Pool Hall Waitlist\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 75,\n        columnNumber: 9\n      }, this), _jsxDEV(Dashboard, {\n        queue: queue,\n        tables: tables,\n        socket: socket\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 73,\n    columnNumber: 5\n  }, this);\n}\nexport default function App() {\n  return _jsxDEV(AuthProvider, {\n    children: _jsxDEV(AppInner, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 84,\n    columnNumber: 5\n  }, this);\n}\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    marginTop: 50,\n    paddingHorizontal: 16\n  },\n  title: {\n    fontSize: 28,\n    fontWeight: 'bold',\n    textAlign: 'center',\n    marginBottom: 24\n  }\n});","map":{"version":3,"names":["React","useState","useEffect","useContext","SafeAreaView","ScrollView","StyleSheet","Text","Platform","Dashboard","LoginScreen","AuthProvider","AuthContext","io","Constants","jsxDEV","_jsxDEV","API_BASE_URL","_Constants$expoConfig","expoConfig","_Constants$expoConfig2","extra","apiBaseUrl","AppInner","_useContext","user","setUser","_useState","_useState2","_slicedToArray","queue","setQueue","_useState3","_useState4","tables","setTables","_useState5","_useState6","socket","setSocket","_useState7","_useState8","loading","setLoading","fetch","credentials","then","res","json","data","success","catch","err","console","error","finally","socketClient","withCredentials","on","_ref","disconnect","style","textAlign","marginTop","children","fileName","_jsxFileName","lineNumber","columnNumber","styles","container","title","App","create","flex","paddingHorizontal","fontSize","fontWeight","marginBottom"],"sources":["D:/pool-hall-waitlist/frontend/App.js"],"sourcesContent":["import React, { useState, useEffect, useContext } from 'react';\r\nimport { SafeAreaView, ScrollView, StyleSheet, Text, Platform } from 'react-native';\r\nimport Dashboard from './components/Dashboard';\r\nimport LoginScreen from './components/LoginScreen';\r\nimport { AuthProvider, AuthContext } from './contexts/AuthContext';\r\nimport io from 'socket.io-client';\r\nimport Constants from 'expo-constants';\r\n\r\nconst API_BASE_URL = Constants.expoConfig?.extra?.apiBaseUrl || 'http://localhost:3000';\r\n\r\nfunction AppInner() {\r\n  const { user, setUser } = useContext(AuthContext);\r\n  const [queue, setQueue] = useState([]);\r\n  const [tables, setTables] = useState([]);\r\n  const [socket, setSocket] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  // On app load, check if user session exists\r\n  useEffect(() => {\r\n    fetch(`${API_BASE_URL}/api/auth/success`, {\r\n      credentials: 'include',  // Important to send cookies\r\n    })\r\n      .then(res => res.json())\r\n      .then(data => {\r\n        if (data.success) {\r\n          setUser(data.user);\r\n        } else {\r\n          setUser(null);\r\n        }\r\n      })\r\n      .catch(err => {\r\n        console.error('Auth check failed:', err);\r\n        setUser(null);\r\n      })\r\n      .finally(() => setLoading(false));\r\n  }, [setUser]);\r\n\r\n  // Setup socket only if user is logged in\r\n  useEffect(() => {\r\n    if (!user) return;\r\n\r\n    const socketClient = io(API_BASE_URL, {\r\n      withCredentials: true,  // allow cookies\r\n      // don't send token since you use cookie sessions\r\n    });\r\n\r\n    setSocket(socketClient);\r\n\r\n    socketClient.on('state_update', ({ queue, tables }) => {\r\n      setQueue(queue);\r\n      setTables(tables);\r\n    });\r\n\r\n    socketClient.on('connect_error', (err) => {\r\n      console.error('Socket connection error:', err);\r\n    });\r\n\r\n    return () => {\r\n      socketClient.disconnect();\r\n    };\r\n  }, [user]);\r\n\r\n  if (loading) {\r\n    return <Text style={{ textAlign: 'center', marginTop: 50 }}>Loading...</Text>;\r\n  }\r\n\r\n  if (!user) {\r\n    // Not logged in, show LoginScreen\r\n    return <LoginScreen />;\r\n  }\r\n\r\n  return (\r\n    <SafeAreaView style={styles.container}>\r\n      <ScrollView>\r\n        <Text style={styles.title}>Pool Hall Waitlist</Text>\r\n        <Dashboard queue={queue} tables={tables} socket={socket} />\r\n      </ScrollView>\r\n    </SafeAreaView>\r\n  );\r\n}\r\n\r\nexport default function App() {\r\n  return (\r\n    <AuthProvider>\r\n      <AppInner />\r\n    </AuthProvider>\r\n  );\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  container: { flex: 1, marginTop: 50, paddingHorizontal: 16 },\r\n  title: { fontSize: 28, fontWeight: 'bold', textAlign: 'center', marginBottom: 24 },\r\n});\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}